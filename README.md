1. Постановка задачи

Разработать парсер для получения актуальных курсов валют с сайта Центробанка РФ.
Парсер должен принимать на вход дату (в формате DD/MM/YYYY) и возвращать структурированные данные по всем валютам: код валюты, название, номинал, курс за единицу, а также текстовое значение курса.
Результат работы сохраняется в Excel-файл для последующего анализа.

Функции парсера (fetch_cbr_rates_xml, parse_cbr_xml, save_to_excel) построены как отдельные, независимые блоки, не требующие внешних зависимостей, кроме стандартных библиотек Python (requests, pandas, xml).
Это позволяет легко интегрировать их в более сложные системы:

объединять с другими источниками данных,

запускать в цикле для диапазонов дат,

расширять функционал (например, фильтрация валют, преобразование в JSON, автоматическая загрузка в Google Sheets).

2. Инструкция по сборке и запуску

Установить необходимые библиотеки:

pip install requests pandas openpyxl


Скопировать код парсера в Python-файл, например cbr_parser.py.

Вызвать функции для получения данных за нужную дату:

date_for_rates = "06/10/2025"  # можно изменить на любую дату DD/MM/YYYY

xml_bytes = fetch_cbr_rates_xml(date_for_rates)

rows = parse_cbr_xml(xml_bytes)

df = save_to_excel(rows, f'cbr_rates_{date_for_rates.replace("/", "-")}.xlsx')


Файл Excel cbr_rates_06-10-2025.xlsx будет создан в рабочей директории.

Для повторного использования можно импортировать функции из cbr_parser.py в другие проекты.
